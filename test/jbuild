(jbuild_version 1)

(rule
 ((targets   (run_tests.ml))
  (deps      ((files_recursively_in ../lib)))
  (action    (system "echo -n ${^} | awk 'BEGIN {RS=\" \"} /.ml$/ { print }' | xargs qtest extract -o ${@}"))))

(executable
  ((name      run_tests)
   (modules   (run_tests))
   (libraries (qcheck giantbomb cli))))

(alias
 ((name   runtest)
  (deps   (run_tests.exe))
  (action (run ${<}))))
